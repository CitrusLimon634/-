#### 事务基本概念

事务（Transaction）是作为完整的工作单元执行的一系列操作。
如果一个事务中的所有操作都成功，则事务成功，其对数据库的更改都会成为永久性的更改。
如果事务中的任何一个操作失败，则整个事务失败，其中所完成的操作均被取消，所有对数据的更改均无效。 

##### 基本概念

事务是用户定义的数据操作系列，这些操作要么全部执行，要么全部不执行，作为一个完整的不可分割的工作单元。 

##### 事务的特征

* 原子性（Atomicity）：事务是数据库的逻辑工作单位，事务中包括的操作要么都做，要么都不做。 
* 一致性（Consistency）：事务执行的结果必须是使数据库从一个一致性状态变到另一个一致性状态。
* 一致性状态：数据库中只包含成功事务所提交的结果。
* 不一致性状态：数据库中包含错误事务的结果。
* 隔离性（Isolation）：对并发操作，数据库中一个正执行的事务内部不能被其它事务干扰。
  一个事务内部的操作及使用的数据对其他并发事务是隔离的；
* 持久性（Durability）：也称永久性，指事务一旦提交，其对数据库中数据的改变是永久的。

事务是并发控制和数据恢复的基本单位。

##### ISO事务处理模型  --  明尾暗头

```sql
UPDATE 支付表 
        SET 帐户总额 ＝ 帐户总额 － n
		    WHERE 帐户名 ＝ ‘A’
UPDATE 支付表 
        SET 帐户总额 ＝ 帐户总额 ＋ n
		    WHERE 帐户名 ＝ ‘B’
COMMIT  --事务结束符
```



##### T-SQL事务处理模型  --  明头明尾

```sql
--每个事务都有显式的开始和结束标记。
--事务的开始标记是：
BEGIN TRANSACTION | TRAN
--事务的结束标记为：
COMMIT ［TRANSACTION｜TRAN］
ROLLBACK ［TRANSACTION｜TRAN］
```

