##### 1. 备份数据库

##### 2. 恢复数据库

##### 3. 备份内容及备份时间

###### 备份内容

系统数据库：
Master：系统和用户数据库全部信息，如登录帐号、用户、环境变量和数据字典等；
Msdb：Agent服务的全部信息，如作业调度；
Model：创建用户数据库的模板信息
Tempdb：临时数据库
用户数据库

###### 备份时间

系统数据库：修改之后备份
用户数据库：周期性备份

##### 备份设备

#### 4. SQL Server支持的备份类型

##### 完全备份

恢复的基线
在备份时不影响用户对数据库的操作
备份数据文件、数据库对象和数据的信息。
备份数据库时将备份过程中所发生的活动也全部备份下来。

##### 差异备份

备份从上次完全备份之后改变的内容，包括数据、日志和其他被修改的对象。
进行差异备份时也会将差异备份过程中发生的活动备份。
比完全备份节约时间

##### 日志备份

备份从上次日志备份之后的日志记录
日志备份完成后要截断日志：清除掉无用的日志
对故障还原模型的要求：
不能是“简单”的（默认还原模式）还原模式
必须在对数据库进行完全或差异备份之前先将故障还原模型设置为“完全”或“大容量日志记录”方式。
出于简单、安全角度来考虑，建议在进行各种备份之前，都使用“完全”还原模型。

##### 文件和文件组备份

#### 5. 备份策略

##### 完全备份 

适合于**数据库数据不**是很**大**，而且**数据更改不是很频繁**的情况。 

##### 完全备份 + 日志备份

如果**不允许丢失太多的数据**，而且又**不希望经常地进行完全备份**，则可以在完全备份中间加一些日志备份。 

##### 完全备份 + 差异备份 + 日志备份

适合**数据量非常大**的数据库，且**要求丢失的数据非常小**，采取这种方式备份和恢复的速度都比较快，且系统故障时，丢失的数据较少。 

#### 6. 实现备份

使用Transact-SQL语句备份数据库 

###### 备份数据库

```sql
BACKUP DATABASE 数据库名
TO { < 备份设备名 > } | { DISK | TAPE } = {‘物理备份文件名’}
[ WITH
[ DIFFERENTIAL ]
[ [ , ] { INIT | NOINIT } ] ]
```

* DIFFERENTIAL：进行差异备份；
* INIT：本次备份数据库将重写备份设备；
* NOINIT：本次备份数据库将追加到备份设备上。

###### 备份日志

```sql
BACKUP LOG 数据库名
TO { < 备份设备名 > } | { DISK | TAPE } = {‘物理备份文件名’}
[ WITH
 [ { INIT | NOINIT } ]
 [ { [ , ] NO_LOG | TRUNCATE_ONLY | 
      NO_TRUNCATE } ]    ]
```

* NO_LOG和TRUNCATE_ONLY：备份完日志后截断不活动日志。
* NO_TRUNCATE：备份完日志后不截断不活动日志。



实现恢复

```sql
恢复数据库
RESTORE DATABASE 数据库名
FROM  备份设备名  
[ WITH FILE = 文件号
	[ , ] NORECOVERY
	[ , ] RECOVERY 
]

恢复日志
RESTORE LOG 数据库名
FROM  备份设备名  
[ WITH FILE = 文件号
	    [ , ] NORECOVERY
	    [ , ] RECOVERY 
]

--1、首先恢复完全备份
RESTORE DATABASE Student FROM BK1
WITH FILE=1, NORECOVERY
--2、然后恢复差异备份
RESTORE DATABASE Student FROM BK1
WITH FILE=2, NORECOVERY
--3、最后恢复日志备份
RESTORE LOG Student FROM BK1 with file=3
```

